@page "/tts-test"
@using Microsoft.JSInterop
@inject IJSRuntime JS

<PageTitle>TTS Test</PageTitle>

<h3>Text-to-Speech Test</h3>

<div class="mb-3">
    <label for="textInput" class="form-label">Text to speak:</label>
    <textarea id="textInput" class="form-control" rows="3" @bind="textToSpeak"></textarea>
</div>

<div class="mb-3">
    <label for="voiceSelect" class="form-label">Voice:</label>
    <select id="voiceSelect" class="form-select" @bind="selectedVoice">
        <option value="alloy">Alloy</option>
        <option value="echo">Echo</option>
        <option value="fable">Fable</option>
        <option value="onyx">Onyx</option>
        <option value="nova">Nova</option>
        <option value="shimmer">Shimmer</option>
    </select>
</div>

<div class="mb-3">
    <label for="speedInput" class="form-label">Speed: @speed.ToString("F1")</label>
    <input type="range" class="form-range" id="speedInput" min="0.5" max="2.0" step="0.1" @bind="speed" />
</div>

<button class="btn btn-primary" @onclick="PlaySpeech">
    <i class="bi bi-play-fill"></i> Speak
</button>

@code {
    private string textToSpeak = "Hello! This is a test of the Azure OpenAI text-to-speech service.";
    private string selectedVoice = "alloy";
    private float speed = 1.0f;

    private async Task PlaySpeech()
    {
        if (!string.IsNullOrWhiteSpace(textToSpeak))
        {
            await JS.InvokeVoidAsync("ttsPlayer.play", textToSpeak, selectedVoice, speed);
        }
    }
}
